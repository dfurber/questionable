"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react"),r=require("use-wizard"),i=require("lodash"),o=require("@trussworks/react-uswds"),n=require("luxon"),s=require("file-saver"),a=require("@ramonak/react-progress-bar"),p=require("@rjsf/semantic-ui"),c=require("class-validator");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=u(s),d=u(a),f=u(p);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function g(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var i,o,n=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return n}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h,m,O=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),this.started=void 0,this.finished=void 0,this.birthdate=void 0,this.age=void 0,this.responses=[],Object.assign(this,t),this.started=new Date},S=t.createContext({setState:{},state:{}}),P=function(){var e=t.useContext(S);if(!e)throw new Error("useGlobalState must be used within a GlobalStateContext");return e},E=function(r){var i=r.children,o=r.value,n=void 0===o?{}:o,s=b(t.useState(n),2),a=s[0],p=s[1];return e.jsx(S.Provider,Object.assign({value:{setState:p,state:a}},{children:i}),void 0)},j=function(){var e=P().state.questionnaire;if(!e)throw new Error("useQuestionnaire has no data");return e},T=function(){var e=P().state.config;if(!e)throw new Error("useConfig has no data");return e},x=function(){return{config:T(),questionnaire:j()}};function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}exports.QUESTION_TYPE=void 0,(h=exports.QUESTION_TYPE||(exports.QUESTION_TYPE={})).DOB="dob",h.MULTIPLE_CHOICE="multiple_choice",h.MULTIPLE_SELECT="multiple_select",exports.PAGE_TYPE=void 0,(m=exports.PAGE_TYPE||(exports.PAGE_TYPE={})).LANDING="Landing",m.NO_RESULTS="No Results",m.RESULTS="Results",m.SUMMARY="Summary",exports.DESIGN_TYPE=void 0,(exports.DESIGN_TYPE||(exports.DESIGN_TYPE={})).EDIT="Edit";var C,_,R,N,D,q,B,L=A(A(A({},exports.PAGE_TYPE),exports.QUESTION_TYPE),exports.DESIGN_TYPE);exports.DIRECTION=void 0,(C=exports.DIRECTION||(exports.DIRECTION={}))[C.FORWARD=1]="FORWARD",C[C.BACKWARD=-1]="BACKWARD",exports.PROGRESS_BAR_STATUS=void 0,(_=exports.PROGRESS_BAR_STATUS||(exports.PROGRESS_BAR_STATUS={})).COMPLETE="complete",_.CURRENT="current",_.INCOMPLETE="incomplete",exports.ACTION=void 0,(R=exports.ACTION||(exports.ACTION={})).CALL="call",R.HYBRID="hybrid",R.ONLINE="online",exports.ACTION_TYPE=void 0,(N=exports.ACTION_TYPE||(exports.ACTION_TYPE={})).RESET="RESET",N.UPDATE="UPDATE",exports.DATE_UNIT=void 0,(D=exports.DATE_UNIT||(exports.DATE_UNIT={})).DAY="day",D.MONTH="month",D.YEAR="year",exports.MODE=void 0,(q=exports.MODE||(exports.MODE={})).DEV="dev",q.EDIT="edit",q.VIEW="view",exports.CSS_CLASS=void 0,(B=exports.CSS_CLASS||(exports.CSS_CLASS={})).BASE="usds-q",B.DEV_PANEL_SECTION="usds-q-dev-panel",B.DOB="usds-q-dob",B.MULTI_CHOICE="usds-q-multi-choice",B.MULTI_CHOICE_GROUP="usds-q-multi-choice-group",B.MULTI_SELECT="usds-q-multi-select",B.MULTI_SELECT_GROUP="usds-q-multi-select-group",B.NAVBAR="usds-q-navbar",B.NAVBAR_BUTTON="usds-q-navbar-button",B.PROGRESS_BAR="usds-q-progress-bar",B.PROGRESS_BAR_BOTTOM_SECTION="usds-q-progress-bar-bottom-section",B.PROGRESS_BAR_TOP_SECTION="usds-q-progress-bar-top-section",B.RESULTS_SUMMARY_BOX="usds-q-results-summary-box",B.RESULTS_SUMMARY_HEADER="usds-q-results-summary-header",B.STEP_FOOTER="usds-q-step-footer",B.STEP_HEADER="usds-q-step-header",B.STEP_INFO="usds-q-step-info",B.STEP_LAYOUT="usds-q-step-layout",B.STEP_LAYOUT_SECTION="usds-q-step-layout-section",B.STEP_SUBTITLE="usds-q-step-subtitle";var U=function(e,t){return Object.values(e).includes(t)};function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=function(e,t){switch(null==t?void 0:t.type){case exports.ACTION_TYPE.RESET:return new O;case exports.ACTION_TYPE.UPDATE:return i.merge(Y({},e),Y({},t.value));default:return e}},G=require("moment"),$=function(e){return!(!e||e.length<8)&&!!G(e,"MM/DD/YYYY",!0).isValid()},Q=function(e){if($(e)){var t=new Date(+e.substring(6,10),+e.substring(0,2)-1,+e.substring(3,5));return n.DateTime.fromJSDate(t)}},F=function(e){var t=n.DateTime.now(),r=t.year,i=t.month,o=t.day,s=e.year,a=e.month,p=e.day,c=r-s,u=0;i>=a?u=i-a:(c-=1,u=12+i-a);var l=0;return o>=p?l=o-p:(l=31+o-p,(u+=-1)<0&&(u=11,c-=1)),{days:l,months:u,years:c}},H=function(e){if(e&&$(e)){var t=Q(e);if(t)return F(t)}};function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function z(e,t,r){return t&&V(e.prototype,t),r&&V(e,r),e}var W=function(){function e(){v(this,e)}return z(e,null,[{key:"sanitize",value:function(e){return e.toLowerCase().trim()}},{key:"matches",value:function(t,r){return!(!t||!r)&&e.sanitize(t)===e.sanitize(r)}}]),e}();function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var X=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.log(K({},t))},Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t||r)&&X("Created an empty element",t,r),e.jsx(e.Fragment,{children:t},void 0)},ee=function(){function t(){v(this,t)}return z(t,null,[{key:"getHeader",value:function(t,r){var i,o,n=null===(i=t.step)||void 0===i?void 0:i.title;if(!n)return Z();r.steps.showStepId&&(n="".concat(null===(o=t.step)||void 0===o?void 0:o.id,": ").concat(n));return e.jsx("h3",Object.assign({className:"usa-card__heading ".concat(exports.CSS_CLASS.STEP_HEADER)},{children:n}),void 0)}},{key:"getSubtitle",value:function(t){var r,i=null===(r=t.step)||void 0===r?void 0:r.subTitle;return i?e.jsx("p",{className:exports.CSS_CLASS.STEP_SUBTITLE,dangerouslySetInnerHTML:{__html:i}},void 0):Z()}},{key:"getInfoBox",value:function(t){var r,i=null===(r=t.step)||void 0===r?void 0:r.info;return i?e.jsx(o.SiteAlert,Object.assign({variant:"info",showIcon:!1,className:"outline-1px ".concat(exports.CSS_CLASS.STEP_INFO)},{children:i}),void 0):Z()}},{key:"getFooter",value:function(t){var r,i=null===(r=t.step)||void 0===r?void 0:r.footer;return i?e.jsx("p",{className:"font-sans-6 ".concat(exports.CSS_CLASS.STEP_FOOTER),dangerouslySetInnerHTML:{__html:i}},void 0):Z()}},{key:"resetQuestionable",value:function(e){e.dispatchForm({type:exports.ACTION_TYPE.RESET}),e.wizard.goToStep("A")}},{key:"saveAsJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"questionable.json",r=new Blob([e],{type:"text/plain;charset=utf-8"});l.default.saveAs(r,t)}}]),t}(),te=function(t){if(!x().config.dev)return Z();return e.jsxs(e.Fragment,{children:[e.jsx(o.Accordion,{items:[{content:e.jsx("pre",{children:e.jsx("code",{children:JSON.stringify(t.form,null,4)},void 0)},void 0),expanded:!1,id:"developer-output",title:"Temporary developer panel"}]},void 0),e.jsx("br",{},void 0),e.jsx("nav",Object.assign({className:exports.CSS_CLASS.NAVBAR},{children:e.jsx(o.Button,Object.assign({type:"reset",secondary:!0,onClick:function(){return ee.resetQuestionable(t)}},{children:"Reset"}),void 0)}),void 0)]},void 0)},re=function(t){var r=x(),i=r.config,o=r.questionnaire;if(i.progressBar.hide)return Z();var n=o.getProgressPercent(t,i);return e.jsx("div",Object.assign({className:exports.CSS_CLASS.PROGRESS_BAR},{children:e.jsx(d.default,{completed:n,bgColor:i.progressBar.bgColor,baseBgColor:i.progressBar.baseBgColor,isLabelVisible:!1,borderRadius:"0px"},void 0)}),void 0)},ie=function(t){return e.jsx(o.StepIndicatorStep,{label:t.name,status:t.status||"incomplete"},t.id)},oe=function(t){var r=x(),i=r.config,n=r.questionnaire;if(i.progressBar.hide)return Z();var s=n.getSections(t,i);return 0===s.length?Z():e.jsx(o.StepIndicator,Object.assign({centered:!0,counters:"small"},{children:s.map(ie)}),void 0)},ne=function(t){var r=t.props,i=t.position,o=x().config;if(o.progressBar.hide||o.progressBar.position!==i)return Z();switch(o.progressBar.type){case"progress-bar":return e.jsx(re,Object.assign({},r),void 0);case"step-indicator":return e.jsx(oe,Object.assign({},r),void 0);default:return Z("Could not find progress type",o.progressBar.type)}},se={$schema:"http://json-schema.org/draft-07/schema#",definitions:{ACTION:{enum:["call","hybrid","online"],type:"string"},DESIGN_TYPE:{const:"Edit",description:"Defines the known component types for design",type:"string"},IAction:{description:"Represents something the customer can do in response to receiving a result",properties:{action:{title:"Action",type:"string"},description:{title:"Description",type:"string"},name:{type:"string"},title:{title:"Title",type:"string"},type:{$ref:"#/definitions/ACTION",title:"Type"}},required:["action","description","name","title","type"],type:"object"},IButtonConfig:{description:"Configuration for buttons",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},required:["defaultLabel","horizontalPos","mode","verticalPos"],type:"object"},IDesignData:{description:"Data defintion for design step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IStep",description:"Current step"}},required:["form","step"],type:"object"},IForm:{description:"Represents the survey as completed by the user",properties:{age:{$ref:"#/definitions/TAge",description:"Customer's age in years/months/days",title:"Age"},birthdate:{description:"Customer's entered birthdate",title:"Birthdate",type:"string"},finished:{description:"Time the survey was completed",format:"date-time",title:"Finished",type:"string"},responses:{description:"All currently provided responses",items:{$ref:"#/definitions/IQuestion"},title:"Responses",type:"array"},started:{description:"Time the survey was started",format:"date-time",title:"Started",type:"string"}},required:["responses","started"],type:"object"},INavButton:{description:"Represents a navigation button",properties:{label:{description:"Text to display on button (e.g. 'Prev' or 'Next')",type:"string"}},required:["label"],type:"object"},INavigationConfig:{description:"Configuration for navigation",properties:{next:{description:"Next/Forward button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"},prev:{description:"Previous/Go back button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"}},required:["next","prev"],type:"object"},IPage:{description:"Defines step content for Page types",properties:{body:{description:"Defines the body content of the page",title:"Body",type:"string"},bodyHeader:{description:"Optional header to display above body",title:"Body Heading",type:"string"},bodySubHeader:{description:"Optional sub header to display below Body Heading",title:"Body Subheading",type:"string"},buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/PAGE_TYPE",description:"Type of page",title:"Page Type"}},required:["section","title","type"],type:"object"},IPageData:{description:"Data defintion for page step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IPage",description:"Current step"}},required:["form","step"],type:"object"},IPages:{description:"Defines required pages for the survey flow",properties:{landingPage:{$ref:"#/definitions/IPage",description:"First step of the survey",title:"Landing Page"},noResultsPage:{$ref:"#/definitions/IPage",description:"Last step of the survey if there are 0 results",title:"No Results Page"},resultsPage:{$ref:"#/definitions/IPage",description:"Last step of the survey if there are 1 or more results",title:"Results Page"},summaryPage:{$ref:"#/definitions/IPage",description:"Preview of survery before submitting to receive results",title:"Summary Page"}},required:["landingPage","noResultsPage","resultsPage","summaryPage"],type:"object"},IProgressBarConfig:{description:"Configuration options for the progress bar",properties:{baseBgColor:{description:"Color of the non-completed pb",title:"Base Background Color",type:"string"},bgColor:{description:"Color of the completed pb",title:"Background Color",type:"string"},hide:{default:!1,description:"Toggles whether to show progress bar",title:"Show Progress Bar",type:"boolean"},position:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation of the progress bar",title:"Position"},type:{$ref:"#/definitions/TProgressBarType",description:"Component type\n\nCan be one of two types: (1) The USWDS Step Indicator @see https://trussworks.github.io/react-uswds/?path=/docs/components-step-indicator (2) React progress bar @see https://katerinalupacheva.github.io/react-progress-bar/",title:"Type"}},required:["baseBgColor","bgColor","hide","position","type"],type:"object"},IQuestion:{description:"Defines step content for Question type",properties:{answers:{description:"Collection of allowed answers",items:{$ref:"#/definitions/IQuestionAnswer"},title:"Answers",type:"array"},buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/QUESTION_TYPE",description:"Type of question",title:"Question Type"}},required:["answers","section","title","type"],type:"object"},IQuestionAnswer:{description:"Definition for answers to questions",properties:{id:{type:"string"},order:{type:"number"},title:{type:"string"}},required:["id","title"],type:"object"},IQuestionConfig:{description:"Configuration for question display",properties:{showAnswerBorder:{default:!0,description:"Determines whether to show border on radios and checkboxes",title:"Show Answer Border",type:"boolean"}},required:["showAnswerBorder"],type:"object"},IQuestionData:{description:"Data defintion for question step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IQuestion",description:"Current step"}},required:["form","step"],type:"object"},IQuestionableConfig:{description:"Configuration for customized behavior of Questionable",properties:{mode:{$ref:"#/definitions/MODE",description:"View or edit mode",title:"Mode"},nav:{description:"Navigation configuration",properties:{next:{description:"Next/Forward button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"},prev:{description:"Previous/Go back button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"}},title:"Navigation",type:"object"},progressBar:{description:"Progress Bar configuration",properties:{baseBgColor:{description:"Color of the non-completed pb",title:"Base Background Color",type:"string"},bgColor:{description:"Color of the completed pb",title:"Background Color",type:"string"},hide:{default:!1,description:"Toggles whether to show progress bar",title:"Show Progress Bar",type:"boolean"},position:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation of the progress bar",title:"Position"},type:{$ref:"#/definitions/TProgressBarType",description:"Component type\n\nCan be one of two types: (1) The USWDS Step Indicator @see https://trussworks.github.io/react-uswds/?path=/docs/components-step-indicator (2) React progress bar @see https://katerinalupacheva.github.io/react-progress-bar/",title:"Type"}},title:"Progress Bar",type:"object"},questions:{description:"Question configuration",properties:{showAnswerBorder:{default:!0,description:"Determines whether to show border on radios and checkboxes",title:"Show Answer Border",type:"boolean"}},title:"Question Configuration",type:"object"},steps:{description:"Step configuration",properties:{borderClass:{description:"Class determines whether cards have borders",enum:["border-ink","border-0"],title:"Border Class",type:"string"},showStepId:{default:!1,description:"Toggles whether steps' ids are shown next to the question text",title:"Show Step Id",type:"boolean"},titleClass:{description:"Class to apply to title. Use to add background to question text",enum:["bg-base-lightest",""],title:"Title Class",type:"string"}},title:"Step Configuration",type:"object"}},required:["mode","nav"],type:"object"},IQuestionnaire:{description:"Definition for survey data input",properties:{actions:{items:{$ref:"#/definitions/IAction"},type:"array"},header:{type:"string"},pages:{$ref:"#/definitions/IPages"},questions:{items:{$ref:"#/definitions/IQuestion"},type:"array"},results:{items:{$ref:"#/definitions/IResult"},type:"array"},sections:{items:{$ref:"#/definitions/ISection"},type:"array"}},required:["actions","header","pages","questions","results","sections"],type:"object"},IRequirement:{description:"Defines an individual requirement for accessing a step",properties:{explanation:{description:"User facing description of this requirement",title:"Exlanation",type:"string"},maxAge:{$ref:"#/definitions/TAge",description:"Optional maximum age allowed for this requirement",title:"Maximum Age"},minAge:{$ref:"#/definitions/TAge",description:"Optional minimum age allowed for this requirement",title:"Minimum Age"},responses:{description:"Map of step id to required answer values",items:{$ref:"#/definitions/IResponse"},title:"Answers",type:"array"}},required:["responses"],type:"object"},IResponse:{description:"Acceptable responses",properties:{answers:{items:{properties:{id:{type:"string"},order:{type:"number"},title:{type:"string"}},type:"object"},type:"array"},question:{properties:{answers:{description:"Collection of allowed answers",items:{$ref:"#/definitions/IQuestionAnswer"},title:"Answers",type:"array"},buttons:{},footer:{},info:{},internalNotes:{},requirements:{},section:{},subTitle:{},title:{},type:{$ref:"#/definitions/QUESTION_TYPE",description:"Type of question",title:"Question Type"}},type:"object"}},required:["answers","question"],type:"object"},IResult:{description:"Represents a potential result based on a customer's answers",properties:{label:{description:"Identify the result (e.g. 'Benefit name')",title:"Label",type:"string"},name:{description:"Name of this result",title:"Name",type:"string"},requirements:{description:"Collection of requirements required to achieve this result",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},required:["label","name","requirements"],type:"object"},ISection:{description:"Defines a survey section, used in progress bar",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},required:["name","requirements"],type:"object"},IStep:{description:"Generic step data definition. Applies to all types of steps.",properties:{buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/TStepType",description:"Step's type, usually implemented by @see{IPageStep} or @see{IQuestionStep}",title:"Step Type"}},required:["section","title","type"],type:"object"},IStepConfig:{description:"Customizations for styling and formatting of the steps",properties:{borderClass:{description:"Class determines whether cards have borders",enum:["border-ink","border-0"],title:"Border Class",type:"string"},showStepId:{default:!1,description:"Toggles whether steps' ids are shown next to the question text",title:"Show Step Id",type:"boolean"},titleClass:{description:"Class to apply to title. Use to add background to question text",enum:["bg-base-lightest",""],title:"Title Class",type:"string"}},required:["borderClass","showStepId","titleClass"],type:"object"},IStepData:{description:"Data defintion for base wizard step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IStep",description:"Current step",title:"Step"}},required:["form"],type:"object"},MODE:{enum:["dev","edit","view"],type:"string"},PAGE_TYPE:{description:"Defines the known component types for pages",enum:["Landing","No Results","Results","Summary"],type:"string"},QUESTION_TYPE:{description:"Defines the known component types for questions",enum:["dob","multiple_choice","multiple_select"],type:"string"},TAge:{properties:{days:{maximum:31,minimum:0,title:"Days",type:["number","null"]},months:{maximum:31,minimum:0,title:"Months",type:["number","null"]},years:{maximum:100,minimum:0,title:"Years",type:["number","null"]}},required:["months","years"],type:"object"},TButtonMode:{enum:["link","button"],type:"string"},THorizontalPosition:{enum:["left","right"],type:"string"},TProgressBarType:{enum:["step-indicator","progress-bar"],type:"string"},TStepType:{anyOf:[{$ref:"#/definitions/PAGE_TYPE"},{$ref:"#/definitions/QUESTION_TYPE"},{$ref:"#/definitions/DESIGN_TYPE"}]},TVerticalPosition:{enum:["top","bottom"],type:"string"}}};function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce={properties:{step:{$ref:"#/definitions/IStep",title:"Step"}}},ue=pe(pe({type:"object"},ce),se),le=function(){function t(){v(this,t)}return z(t,null,[{key:"getReason",value:function(e,t,r){var i,o=null===(i=t.match)||void 0===i?void 0:i.explanation,n=r.questionnaire,s=r.config;if(!o)return"";if(null!=s&&s.dev&&t.match){var a,p;if(o+="<br><br>",void 0!==t.match.ageCalc||void 0!==t.match.minAge||void 0!==t.match.maxAge)o+="You are ".concat(null===(a=e.form.age)||void 0===a?void 0:a.years," years "),o+="and ".concat(null===(p=e.form.age)||void 0===p?void 0:p.months," months old. ");t.match.responses.forEach((function(e){if(e.question.id){var t=n.getQuestionById(e.question.id);o+='You answered "<b>'.concat(t.answer,'</b>" to the question "<i>').concat(t.title,'.</i>" ')}}))}return o}},{key:"getResults",value:function(r,i){return i.questionnaire.getResults(r.form).map((function(o){return e.jsxs("li",Object.assign({className:"padding-bottom-2"},{children:[e.jsxs("span",{children:[o.label,":","  ",e.jsx("b",{children:o.name},void 0)]},void 0),e.jsx("div",{className:"text-light",dangerouslySetInnerHTML:{__html:t.getReason(r,o,i)}},void 0)]}),"".concat(r.stepId,"_").concat(o.id))}))}}]),t}(),de=function(){function e(){v(this,e)}return z(e,null,[{key:"goToStep",value:function(e,t){t.wizard.goToStep(e)}},{key:"goToNextStep",value:function(t,r,i){e.goToStep(r.getNextStep(t,i),t)}},{key:"goToPrevStep",value:function(t,r,i){e.goToStep(r.getPreviousStep(t,i),t)}},{key:"isNextEnabled",value:function(t){var r,i,o,n;if(null==t||!t.step)throw new Error("This survery is not defined");return t.stepId===L.LANDING||(t.stepId===L.SUMMARY||!!t.form&&((null===(r=t.step)||void 0===r?void 0:r.type)===exports.QUESTION_TYPE.DOB?void 0!==(null===(o=t.form)||void 0===o||null===(n=o.age)||void 0===n?void 0:n.years)&&t.form.age.years>=0:e.isValid(t.form,null===(i=t.step)||void 0===i?void 0:i.id)))}},{key:"isValid",value:function(e,t){var r,o=e.responses.find((function(e){return(null==e?void 0:e.id)===t}));if(!o)return!1;var n=i.values(o.answers);switch(o.type){case L.DOB:return void 0!==(null==e||null===(r=e.age)||void 0===r?void 0:r.years)&&e.age.years>0;case L.MULTIPLE_CHOICE:return void 0!==o.answer&&void 0!==(null==n?void 0:n.find((function(e){return e.title===o.answer})));default:return!0}}},{key:"getFieldSetName",value:function(e){return i.kebabCase(e.step.title)}},{key:"getDomId",value:function(t,r){var o=e.getFieldSetName(r);return"".concat(o,"-").concat(i.kebabCase(t))}}]),e}();function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=function(){function t(){v(this,t)}return z(t,null,[{key:"updateForm",value:function(e,t){Object.assign(t.step,{answer:e}),t.form.responses=t.form.responses||[];var r=t.form.responses.find((function(e){return e.id===t.step.id}));return r?i.merge(r,t.step):t.form.responses.push(t.step),t.dispatchForm({type:exports.ACTION_TYPE.UPDATE,value:ye({},t.form)})}},{key:"isSelected",value:function(e,t){if(null!=t&&t.form){var r=t.form.responses.find((function(e){return e.id===t.step.id}));if(r)return de.isValid(t.form,t.step.id)&&r.answer===e}}},{key:"getRadio",value:function(r,i,n){var s,a=function(){return t.updateForm(r.title,i)},p=de.getDomId(r.title,i);return e.jsx(o.Radio,{id:p,name:de.getFieldSetName(i),label:r.title,value:r.title,checked:!0===t.isSelected(r.title,i),className:exports.CSS_CLASS.MULTI_CHOICE,onChange:a,onClick:a,tile:!0===(null===(s=n.questions)||void 0===s?void 0:s.showAnswerBorder)},p)}},{key:"getRadios",value:function(r,i){return e.jsx(o.Fieldset,Object.assign({legend:r.step.title,className:exports.CSS_CLASS.MULTI_CHOICE_GROUP,legendStyle:"srOnly"},{children:r.step.answers.map((function(e){return t.getRadio(e,r,i)}))}),void 0)}},{key:"getCheckbox",value:function(r,i,n){var s,a=function(){return t.updateForm(r.title,i)},p=de.getDomId(r.title,i);return e.jsx(o.Checkbox,{id:p,name:de.getFieldSetName(i),label:r.title,value:r.title,checked:!0===t.isSelected(r.title,i),className:exports.CSS_CLASS.MULTI_SELECT,onChange:a,onClick:a,tile:!0===(null===(s=n.questions)||void 0===s?void 0:s.showAnswerBorder)},p)}},{key:"getCheckboxes",value:function(r,i){return e.jsx(o.Fieldset,Object.assign({legend:r.step.title,className:exports.CSS_CLASS.MULTI_SELECT_GROUP,legendStyle:"srOnly"},{children:r.step.answers.map((function(e){return t.getCheckbox(e,r,i)}))}),void 0)}},{key:"getBirthdate",value:function(e){var t;if(null!==(t=e.form)&&void 0!==t&&t.birthdate)return Q(e.form.birthdate)}},{key:"toBirthdate",value:function(e){if(e.month&&e.day&&e.year)return"".concat(e.month.padStart(2,"0"),"/").concat(e.day.padStart(2,"0"),"/").concat(e.year)}}]),t}(),be=function(t){return e.jsx(o.Button,Object.assign({className:"".concat(exports.CSS_CLASS.NAVBAR_BUTTON," ").concat(exports.CSS_CLASS.NAVBAR_BUTTON,"-").concat(t.dir),"data-testid":"".concat(t.dir,"-button-").concat(t.stepId),disabled:t.disabled(),onClick:t.onClick,type:"button",unstyled:"link"===t.mode,outline:"link"!==t.mode&&"prev"===t.dir},{children:t.label}),void 0)},ve=function(t){var r,i,o=x(),n=o.questionnaire,s=o.config,a=t.step,p=t.verticalPos!==s.nav.prev.verticalPos,c=t.stepId===L.LANDING||t.stepId===n.flow[1],u=t.stepId===L.RESULTS||t.stepId===L.NO_RESULTS,l=s.mode!==exports.MODE.EDIT||t.stepId===n.flow[0]&&s.mode===exports.MODE.EDIT;if(p||(c||u)&&l)return Z();var d=(null==a||null===(r=a.buttons)||void 0===r||null===(i=r.prev)||void 0===i?void 0:i.label)||s.nav.prev.defaultLabel||"Previous";return e.jsx(be,Object.assign({},{dir:"prev",disabled:function(){return!1},label:d,mode:s.nav.prev.mode||"link",onClick:function(){return de.goToPrevStep(t,n,s)},stepId:"".concat(t.stepId)}),void 0)},he=function(t){var r,i,o=x(),n=o.questionnaire,s=o.config,a=t.step,p=t.verticalPos!==s.nav.next.verticalPos,c=t.stepId===L.RESULTS||t.stepId===L.NO_RESULTS,u=s.mode!==exports.MODE.EDIT||t.stepId===n.flow[n.flow.length-1]&&s.mode===exports.MODE.EDIT;if(p||c&&u)return Z();var l=(null==a||null===(r=a.buttons)||void 0===r||null===(i=r.next)||void 0===i?void 0:i.label)||s.nav.next.defaultLabel||"Previous";return e.jsx(be,Object.assign({},{dir:"next",disabled:function(){return s.mode===exports.MODE.VIEW&&!de.isNextEnabled(t)},label:l,mode:s.nav.next.mode||"button",onClick:function(){return de.goToNextStep(t,n,s)},stepId:"".concat(t.stepId)}),void 0)},me=function(t){return e.jsxs("nav",Object.assign({className:"".concat(exports.CSS_CLASS.NAVBAR," ").concat(exports.CSS_CLASS.NAVBAR,"-").concat(t.verticalPos)},{children:[e.jsx(ve,Object.assign({},t),void 0),e.jsx(he,Object.assign({},t),void 0)]}),void 0)};function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pe=function(t){var r=x().questionnaire;return e.jsxs("div",{children:[e.jsx(me,Object.assign({},Se(Se({},t),{},{verticalPos:"top"})),void 0),e.jsx("section",{children:e.jsx(o.CardGroup,{children:e.jsxs(o.Card,Object.assign({headerFirst:!0,gridLayout:{tablet:{col:12}},containerProps:{className:"border-ink"}},{children:[e.jsx(o.CardHeader,Object.assign({className:"bg-base-lightest"},{children:e.jsxs("h1",{children:["Edit the ",r.header]},void 0)}),void 0),e.jsx(o.CardBody,Object.assign({className:"padding-top-3"},{children:t.children}),void 0),e.jsx(o.CardFooter,{children:'Click "Save" to save your edits, or "Next" to continue editing'},void 0)]}),void 0)},void 0)},void 0)]},void 0)},Ee=function(t){var r=x().questionnaire,n=function(e){var t=pe({},ce);return U(exports.PAGE_TYPE,e.step.type)?t.properties.step.$ref="#/definitions/IPage":U(exports.QUESTION_TYPE,e.step.type)&&(t.properties.step.$ref="#/definitions/IQuestion"),i.merge(t,ue)}(t),s=i.kebabCase(r.header);return e.jsx(f.default,Object.assign({schema:n,uiSchema:{step:{"ui:order":["title","subTitle","bodyHeader","bodySubHeader","body","info","footer","*"]}},onSubmit:function(e){var t=e.formData;ee.saveAsJson(t,"".concat(s,".json"))},formData:{step:t.step}},{children:e.jsx("div",{children:e.jsx(o.Button,Object.assign({type:"submit"},{children:"Save"}),void 0)},void 0)}),void 0)},je=function(t){return e.jsx(Pe,Object.assign({},t,{children:e.jsx(Ee,Object.assign({},t),void 0)}),void 0)};function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ae=function(t){var r=x().config,i=r.steps,n=i.borderClass,s=i.titleClass;return e.jsxs("div",{children:[e.jsx(me,Object.assign({},Ie(Ie({},t),{},{verticalPos:"top"})),void 0),e.jsx("section",Object.assign({className:exports.CSS_CLASS.STEP_LAYOUT},{children:e.jsx(o.CardGroup,{children:e.jsxs(o.Card,Object.assign({headerFirst:!0,gridLayout:{tablet:{col:12}},containerProps:{className:n}},{children:[e.jsx(o.CardHeader,Object.assign({className:s},{children:ee.getHeader(t,r)}),void 0),e.jsxs(o.CardBody,{children:[ee.getSubtitle(t),t.children,ee.getInfoBox(t)]},void 0),e.jsx(o.CardFooter,{children:ee.getFooter(t)},void 0)]}),void 0)},void 0)}),void 0),e.jsx(me,Object.assign({},Ie(Ie({},t),{},{verticalPos:"bottom"})),void 0)]},void 0)},Ce=function(t){var r=t.step;return r?e.jsx(Ae,Object.assign({},t,{children:e.jsx("p",{children:r.body},void 0)}),void 0):Z()},_e=function(t){return t.step?e.jsx(Ae,Object.assign({},t),void 0):Z()},Re=function(t){var r=t.step,i=x(),n=i.questionnaire;if(!r)return Z();var s=n.getAction();return e.jsx(Ae,Object.assign({},t,{children:e.jsxs(o.SummaryBox,Object.assign({heading:r.bodyHeader||"",className:exports.CSS_CLASS.RESULTS_SUMMARY_HEADER},{children:[e.jsx("p",{children:r.bodySubHeader},void 0),e.jsx("ul",Object.assign({className:"usa-list usa-list--unstyled ".concat(exports.CSS_CLASS.RESULTS_SUMMARY_BOX)},{children:le.getResults(t,i)}),void 0),e.jsx("p",{dangerouslySetInnerHTML:{__html:(null==r?void 0:r.body)||""}},void 0),e.jsx("h2",{children:s.title},void 0),e.jsx("p",{children:s.description},void 0),e.jsx("p",{dangerouslySetInnerHTML:{__html:s.action}},void 0),"."]}),void 0)}),void 0)},Ne=function(t){var r=t.form.responses.map((function(t){return e.jsx("li",Object.assign({className:"padding-bottom-2"},{children:e.jsxs("span",Object.assign({className:"text-light"},{children:[t.title,":  ",e.jsx("b",{children:t.answer},void 0)]}),void 0)}),t.id)}));return e.jsx("ul",Object.assign({className:"usa-list usa-list--unstyled"},{children:r}),void 0)},De=function(t){return t.step?e.jsx(Ae,Object.assign({},t,{children:Ne(t)}),void 0):Z()};function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}var Ue=function(r){var n,s,a,p,c,u,l=r.step,d={day:null===(n=ge.getBirthdate(r))||void 0===n||null===(s=n.day)||void 0===s?void 0:s.toString(),month:null===(a=ge.getBirthdate(r))||void 0===a||null===(p=a.month)||void 0===p?void 0:p.toString(),year:null===(c=ge.getBirthdate(r))||void 0===c||null===(u=c.year)||void 0===u?void 0:u.toString()},f=b(t.useState(d),2),y=f[0],g=f[1];if(!l)return Z();var v,h=function(e,t){var i=e.target.value;if(i){y[t]=i,g(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},y));var o=ge.toBirthdate(y),n=H(o);n&&r.dispatchForm({type:exports.ACTION_TYPE.UPDATE,value:{age:n,birthdate:o}})}},m=function(t,n){var s=2;return t===exports.DATE_UNIT.YEAR&&(s=4),e.jsx(o.DateInput,{id:de.getDomId(t,r),name:n,label:i.capitalize(t),unit:t,maxLength:s,minLength:s,defaultValue:y[t],onChange:function(e){return h(e,t)}},void 0)};return v="date_of_birth",e.jsxs(o.DateInputGroup,{children:[m(exports.DATE_UNIT.MONTH,v),m(exports.DATE_UNIT.DAY,v),m(exports.DATE_UNIT.YEAR,v)]},void 0)},ke=function(t){return e.jsx(Ae,Object.assign({},t,{children:e.jsx(Ue,Object.assign({},t),void 0)}),void 0)},Ye=function(e){var t,r=x().config;return void 0===(null==e||null===(t=e.step)||void 0===t?void 0:t.answers)?Z():ge.getCheckboxes(e,r)},Me=function(t){return e.jsx(Ae,Object.assign({},t,{children:e.jsx(Ye,Object.assign({},t),void 0)}),void 0)},Ge=function(e){var t,r=x().config;return void 0===(null==e||null===(t=e.step)||void 0===t?void 0:t.answers)?Z("Question and answer are not defined"):ge.getRadios(e,r)},$e=function(t){return e.jsx(Ae,Object.assign({},t,{children:e.jsx(Ge,Object.assign({},t),void 0)}),void 0)};function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var He=function(t,r){return U(exports.QUESTION_TYPE,r.type)?function(t){var r=t.stepId,i=x().questionnaire,o=i.getStepById("".concat(r));if(!U(exports.QUESTION_TYPE,o.type))return Z("Not a question");var n=i.getQuestionById(o.id),s=Fe({},Fe({step:n},t));switch(n.type){case exports.QUESTION_TYPE.DOB:return e.jsx(ke,Object.assign({},s),void 0);case exports.QUESTION_TYPE.MULTIPLE_CHOICE:return e.jsx($e,Object.assign({},s),void 0);case exports.QUESTION_TYPE.MULTIPLE_SELECT:return e.jsx(Me,Object.assign({},s),void 0);default:return Z("Question does not exist","QuestionFactory")}}(t):U(exports.PAGE_TYPE,r.type)?function(t){var r=t.stepId,i=x().questionnaire,o=i.getStepById("".concat(r));if(!U(exports.PAGE_TYPE,o.type))return Z("Not a page");var n=i.getPageById(o.id),s=Be({},Be({step:n},t));switch(n.type){case exports.PAGE_TYPE.LANDING:return e.jsx(Ce,Object.assign({},s),void 0);case exports.PAGE_TYPE.NO_RESULTS:return e.jsx(_e,Object.assign({},s),void 0);case exports.PAGE_TYPE.RESULTS:return e.jsx(Re,Object.assign({},s),void 0);case exports.PAGE_TYPE.SUMMARY:return e.jsx(De,Object.assign({},s),void 0);default:return Z("Page does not exist","PageFactory")}}(t):Z("Step does not exist","StepFactory")},Ve=function(t){var r=t.stepId,i=x(),o=i.questionnaire,n=i.config,s=o.getStepById("".concat(r));return n.mode===exports.MODE.EDIT?function(t,r){var i=xe({},xe({step:x().questionnaire.getStepById(r.id)},t));if(U(exports.QUESTION_TYPE,r.type)){var o=i;return e.jsx(je,Object.assign({},o),void 0)}if(U(exports.PAGE_TYPE,r.type)){var n=i;return e.jsx(je,Object.assign({},n),void 0)}return Z("Not an editable type")}(t,s):He(t,s)};function ze(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var We=0;function Je(e){return"__private_"+We+++"_"+e}function Ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ze=Je("mode"),et=Je("nav"),tt=Je("progressBar"),rt=Je("questions"),it=Je("steps"),ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),Object.defineProperty(this,Ze,{writable:!0,value:exports.MODE.VIEW}),Object.defineProperty(this,et,{writable:!0,value:{next:{defaultLabel:"Next",horizontalPos:"left",mode:"button",verticalPos:"bottom"},prev:{defaultLabel:"Go back",horizontalPos:"left",mode:"link",verticalPos:"top"}}}),Object.defineProperty(this,tt,{writable:!0,value:{baseBgColor:"#f0f0f0",bgColor:"#005ea2",hide:!1,position:"bottom",type:"progress-bar"}}),Object.defineProperty(this,rt,{writable:!0,value:{showAnswerBorder:!0}}),Object.defineProperty(this,it,{writable:!0,value:{borderClass:"border-0",showStepId:!1,titleClass:""}}),i.merge(this,t),this.dev&&(ze(this,it)[it].showStepId=!0)}return z(e,[{key:"dev",get:function(){return ze(this,Ze)[Ze]===exports.MODE.DEV}},{key:"mode",get:function(){return ze(this,Ze)[Ze]},set:function(e){i.isString(e)?U(exports.MODE,e)?ze(this,Ze)[Ze]=e:ze(this,Ze)[Ze]=exports.MODE.VIEW:ze(this,Ze)[Ze]=e}},{key:"nav",get:function(){return Xe({},ze(this,et)[et])},set:function(e){i.merge(ze(this,et)[et],e)}},{key:"progressBar",get:function(){return Xe({},ze(this,tt)[tt])},set:function(e){i.merge(ze(this,tt)[tt],e)}},{key:"questions",get:function(){return Xe({},ze(this,rt)[rt])},set:function(e){i.merge(ze(this,rt)[rt],e)}},{key:"steps",get:function(){return Xe({},ze(this,it)[it])},set:function(e){i.merge(ze(this,it)[it],e)}}]),e}();function nt(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t,r,i){var o,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"===("undefined"==typeof Reflect?"undefined":st(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(n<3?o(s):n>3?o(t,r,s):o(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s}var pt={buttons:{next:{label:"Get Started"}},id:exports.PAGE_TYPE.LANDING,section:{id:exports.PAGE_TYPE.LANDING},title:exports.PAGE_TYPE.LANDING,type:exports.PAGE_TYPE.LANDING},ct={id:exports.PAGE_TYPE.RESULTS,section:{id:exports.PAGE_TYPE.RESULTS},title:exports.PAGE_TYPE.RESULTS,type:exports.PAGE_TYPE.RESULTS},ut={landingPage:pt,noResultsPage:{id:exports.PAGE_TYPE.NO_RESULTS,section:{id:exports.PAGE_TYPE.RESULTS},title:exports.PAGE_TYPE.NO_RESULTS,type:exports.PAGE_TYPE.NO_RESULTS},resultsPage:ct,summaryPage:{buttons:{next:{label:"Submit"}},id:exports.PAGE_TYPE.SUMMARY,section:{id:exports.PAGE_TYPE.RESULTS},title:exports.PAGE_TYPE.SUMMARY,type:exports.PAGE_TYPE.SUMMARY}};function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ft=function(){function e(t){v(this,e),this.questions=void 0,this.header=void 0,this.results=void 0,this.flow=void 0,this.sections=void 0,this.actions=void 0,this.pages=ut,this.steps=void 0,Object.assign(this,t),this.steps=this.questions.map((function(e,t){return dt({order:t},e)})),this.init(),this.flow=this.steps.map((function(e){return e.id}))}return z(e,[{key:"getStepById",value:function(e){var t=this.steps.find((function(t){return t.id===e}));if(!t)throw new Error("Step id: ".concat(e," not found in survery"));return t}},{key:"getPageById",value:function(e){var t=this.getStepById(e);if(!U(exports.PAGE_TYPE,t.type))throw new Error("Step id: ".concat(e," is not a page"));return t}},{key:"getQuestion",value:function(e){if(!e.id)throw new Error("Question ".concat(e," is not defined"));return this.getQuestionById(e.id)}},{key:"getQuestionById",value:function(e){var t=this.getStepById(e);if(!U(exports.QUESTION_TYPE,t.type))throw new Error("Step id: ".concat(e," not a question"));return t}},{key:"getStep",value:function(e,t,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ot,n=-1!==this.flow.indexOf(e)?this.flow[this.flow.indexOf(e)+r]:void 0;if(!n)return e;if(o.mode===exports.MODE.EDIT)return n;if(n===L.RESULTS&&0===this.getResults(t).length)return L.NO_RESULTS;if(n===L.NO_RESULTS&&this.getResults(t).length>0)return L.RESULTS;var s,a=this.getStepById(n);if(null==a||!a.requirements)return n;if(a.requirements.forEach((function(e){var r=i.meetsAllRequirements(e,t);s=void 0===s?r:s||r})),s)return n;var p=this.getStep(n,t,r);return p!==n?p:e}},{key:"getNextStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ot,r=e.stepId;return this.getStep(r,e.form,exports.DIRECTION.FORWARD,t)}},{key:"getPreviousStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ot,r=e.stepId;return this.getStep(r,e.form,exports.DIRECTION.BACKWARD,t)}},{key:"getProgressPercent",value:function(e,t){var r,i;if(W.matches(null===(r=e.step)||void 0===r||null===(i=r.section)||void 0===i?void 0:i.id,exports.PAGE_TYPE.RESULTS))return 100;var o=this.getSections(e,t),n=o[o.length-1];if(null==n||!n.lastStep)return.5;var s=this.flow.indexOf("".concat(e.stepId)),a=n.lastStep+2;return t.mode===exports.MODE.EDIT&&(a=this.flow.length-1),Math.round(s/a*100)}},{key:"getSections",value:function(e,t){var r=this;if(!e)return[];var i=e.stepId,o=this.getStepById(i),n=this.steps.indexOf(o),s=this.sections.filter((function(t){return 0===t.requirements.length||t.requirements.some((function(t){return r.meetsAllRequirements(t,e.form)}))}));return t.mode===exports.MODE.EDIT&&(s=nt(this.sections)),s.map((function(e){var t=dt({},e);return t.lastStep=r.questions.reduce((function(t,r,i){return r.section.id===e.id?i:t}),-1),W.matches(t.id,exports.PAGE_TYPE.RESULTS)?t.lastStep=r.questions.length-2:W.matches(t.id,exports.PAGE_TYPE.LANDING)&&(t.lastStep=0),t.lastStep<0?t.status=exports.PROGRESS_BAR_STATUS.INCOMPLETE:W.matches(t.id,o.section.id)?t.status=exports.PROGRESS_BAR_STATUS.CURRENT:t.lastStep<n&&(t.status=exports.PROGRESS_BAR_STATUS.COMPLETE),t}))}},{key:"getResults",value:function(e){var t=this;return this.results.filter((function(r){return r.requirements.some((function(i){return!!t.meetsAllRequirements(i,e)&&(Object.assign(r,{match:i}),!0)}))}))}},{key:"getAction",value:function(){var e=Math.floor(Math.random()*this.actions.length);return this.actions[e]}},{key:"init",value:function(){var e,t,r;if((null===(e=this.questions)||void 0===e?void 0:e.length)<=0)throw new Error("No questions have been defined.");if((null===(t=this.header)||void 0===t?void 0:t.length)<=0)throw new Error("No header has been defined.");if((null===(r=this.results)||void 0===r?void 0:r.length)<=0)throw new Error("No results have been defined.");var i="step is not correctly defined or defined more than once";if(this.steps[0].type!==exports.PAGE_TYPE.LANDING&&this.steps.unshift(this.pages.landingPage),1!==this.steps.filter((function(e){return e.type===exports.PAGE_TYPE.LANDING})).length)throw new Error("".concat(exports.PAGE_TYPE.LANDING," ").concat(i,"."));if(this.steps[this.steps.length-1].type!==exports.PAGE_TYPE.NO_RESULTS&&this.steps.push(this.pages.noResultsPage),1!==this.steps.filter((function(e){return e.type===exports.PAGE_TYPE.NO_RESULTS})).length)throw new Error("".concat(exports.PAGE_TYPE.NO_RESULTS," ").concat(i,"."));if(this.steps[this.steps.length-2].type!==exports.PAGE_TYPE.RESULTS&&this.steps.splice(this.steps.length-1,0,this.pages.resultsPage),1!==this.steps.filter((function(e){return e.type===exports.PAGE_TYPE.RESULTS})).length)throw new Error("".concat(exports.PAGE_TYPE.RESULTS," ").concat(i,"."));if(this.steps[this.steps.length-3].type!==exports.PAGE_TYPE.SUMMARY&&this.steps.splice(this.steps.length-2,0,this.pages.summaryPage),1!==this.steps.filter((function(e){return e.type===exports.PAGE_TYPE.SUMMARY})).length)throw new Error("".concat(exports.PAGE_TYPE.SUMMARY," ").concat(i,"."))}},{key:"meetsAllRequirements",value:function(t,r){var i=t.minAge,o=t.maxAge,n=t.responses,s=t.ageCalc;return e.meetsMinAgeRequirements(r,i)&&e.meetsMaxAgeRequirements(r,o)&&e.meetsAgeCalcRequirements(r,s)&&this.meetsAnswerRequirements(n)}},{key:"meetsAnswerRequirements",value:function(e){var t=this;return!e||e.length<=0||e.every((function(e){var r,i=t.getQuestion(e.question);return!((null===(r=i.answers)||void 0===r?void 0:r.length)>0)||e.answers.some((function(e){var t;return void 0!==i.answer&&i.answer===(null===(t=i.answers.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.title)}))}))}}],[{key:"meetsMinAgeRequirements",value:function(e,t){if(!t)return!0;if(void 0===e.age)return!1;var r=e.age,i=r.years,o=r.months;return i>(null==t?void 0:t.years)||i>=(null==t?void 0:t.years)&&o>=(null==t?void 0:t.months)}},{key:"meetsMaxAgeRequirements",value:function(e,t){if(!t)return!0;if(void 0===e.age)return!1;var r=e.age,i=r.years,o=r.months;return i<(null==t?void 0:t.years)||i<=(null==t?void 0:t.years)&&o<=(null==t?void 0:t.months)}},{key:"meetsAgeCalcRequirements",value:function(e,t){return!t||void 0!==e.birthdate&&t(e.birthdate)}}]),e}();at([c.ArrayUnique((function(e){return e.id}))],ft.prototype,"questions",void 0),at([c.ArrayUnique((function(e){return e.label}))],ft.prototype,"results",void 0),at([c.ArrayUnique((function(e){return e.id}))],ft.prototype,"sections",void 0),exports.Answer=O,exports.Helpers=W,exports.Questionable=function(i){var o=i.questionnaire;if(!o)throw new Error("questionable is undefined");var n=b(r.useWizard(o.flow),2),s=n[0],a=n[1],p=b(t.useReducer(M,new O),2),c=p[0],u=p[1];return e.jsx(E,Object.assign({value:i},{children:e.jsxs("div",Object.assign({className:exports.CSS_CLASS.BASE},{children:[e.jsx("section",Object.assign({className:"section ".concat(exports.CSS_CLASS.PROGRESS_BAR_TOP_SECTION)},{children:e.jsx(ne,Object.assign({},{position:"top",props:{dispatchForm:u,form:c,stepId:s,wizard:a}}),void 0)}),void 0),e.jsx("section",Object.assign({className:"section ".concat(exports.CSS_CLASS.STEP_LAYOUT_SECTION)},{children:e.jsx(Ve,Object.assign({},{dispatchForm:u,form:c,stepId:s,wizard:a}),void 0)}),void 0),e.jsx("section",Object.assign({className:"section ".concat(exports.CSS_CLASS.PROGRESS_BAR_BOTTOM_SECTION)},{children:e.jsx(ne,Object.assign({},{position:"bottom",props:{dispatchForm:u,form:c,stepId:s,wizard:a}}),void 0)}),void 0),e.jsx("section",Object.assign({className:"section ".concat(exports.CSS_CLASS.DEV_PANEL_SECTION)},{children:e.jsx(te,Object.assign({},{dispatchForm:u,form:c,stepId:s,wizard:a}),void 0)}),void 0)]}),void 0)}),void 0)},exports.QuestionableConfig=ot,exports.Questionnaire=ft,exports.STEP_TYPE=L,exports.getAge=H,exports.getDateTime=Q,exports.getDateTimeAge=F,exports.isEnum=U,exports.isValidDate=$,exports.survey=se;
//# sourceMappingURL=index.js.map
