import{jsx as e,Fragment as t,jsxs as i}from"react/jsx-runtime";import{createContext as r,useState as n,useContext as o,useReducer as s}from"react";import{useWizard as a}from"use-wizard";import{merge as c,values as l,kebabCase as u,capitalize as d,isString as p}from"lodash";import{SiteAlert as f,Accordion as y,Button as g,StepIndicator as b,StepIndicatorStep as h,Radio as v,Fieldset as m,Checkbox as O,CardGroup as S,Card as P,CardHeader as w,CardBody as j,CardFooter as T,SummaryBox as E,DateInputGroup as I,DateInput as R}from"@trussworks/react-uswds";import{DateTime as N}from"luxon";import q from"file-saver";import D from"@ramonak/react-progress-bar";import C from"@rjsf/semantic-ui";import{ArrayUnique as A}from"class-validator";function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function k(e,t){if(e){if("string"==typeof e)return B(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?B(e,t):void 0}}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=i){var r,n,o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var x,U,M,$=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_(this,e),this.started=void 0,this.finished=void 0,this.birthdate=void 0,this.age=void 0,this.responses=[],Object.assign(this,t),this.started=new Date},H=r({setState:{},state:{}}),F=function(){var e=o(H);if(!e)throw new Error("useGlobalState must be used within a GlobalStateContext");return e},V=function(t){var i=t.children,r=t.value,o=L(n(void 0===r?{}:r),2),s=o[0],a=o[1];return e(H.Provider,Object.assign({value:{setState:a,state:s}},{children:i}),void 0)},Y=function(){var e=F().state.questionnaire;if(!e)throw new Error("useQuestionnaire has no data");return e},z=function(){var e=F().state.config;if(!e)throw new Error("useConfig has no data");return e},Q=function(){return{config:z(),questionnaire:Y()}};function G(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function W(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function J(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?W(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){e.DOB="dob",e.MULTIPLE_CHOICE="multiple_choice",e.MULTIPLE_SELECT="multiple_select"}(x||(x={})),function(e){e.LANDING="Landing",e.NO_RESULTS="No Results",e.RESULTS="Results",e.SUMMARY="Summary"}(U||(U={})),function(e){e.EDIT="Edit"}(M||(M={}));var K,X,Z,ee,te,ie,re,ne=J(J(J({},U),x),M);!function(e){e[e.FORWARD=1]="FORWARD",e[e.BACKWARD=-1]="BACKWARD"}(K||(K={})),function(e){e.COMPLETE="complete",e.CURRENT="current",e.INCOMPLETE="incomplete"}(X||(X={})),function(e){e.CALL="call",e.HYBRID="hybrid",e.ONLINE="online"}(Z||(Z={})),function(e){e.RESET="RESET",e.UPDATE="UPDATE"}(ee||(ee={})),function(e){e.DAY="day",e.MONTH="month",e.YEAR="year"}(te||(te={})),function(e){e.DEV="dev",e.EDIT="edit",e.VIEW="view"}(ie||(ie={})),function(e){e.BASE="usds-q",e.DEV_PANEL_SECTION="usds-q-dev-panel",e.DOB="usds-q-dob",e.MULTI_CHOICE="usds-q-multi-choice",e.MULTI_CHOICE_GROUP="usds-q-multi-choice-group",e.MULTI_SELECT="usds-q-multi-select",e.MULTI_SELECT_GROUP="usds-q-multi-select-group",e.NAVBAR="usds-q-navbar",e.NAVBAR_BUTTON="usds-q-navbar-button",e.PROGRESS_BAR="usds-q-progress-bar",e.PROGRESS_BAR_BOTTOM_SECTION="usds-q-progress-bar-bottom-section",e.PROGRESS_BAR_TOP_SECTION="usds-q-progress-bar-top-section",e.RESULTS_SUMMARY_BOX="usds-q-results-summary-box",e.RESULTS_SUMMARY_HEADER="usds-q-results-summary-header",e.STEP_FOOTER="usds-q-step-footer",e.STEP_HEADER="usds-q-step-header",e.STEP_INFO="usds-q-step-info",e.STEP_LAYOUT="usds-q-step-layout",e.STEP_LAYOUT_SECTION="usds-q-step-layout-section",e.STEP_SUBTITLE="usds-q-step-subtitle"}(re||(re={}));var oe=function(e,t){return Object.values(e).includes(t)};function se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ae(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?se(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ce=function(e,t){switch(null==t?void 0:t.type){case ee.RESET:return new $;case ee.UPDATE:return c(ae({},e),ae({},t.value));default:return e}},le=require("moment"),ue=function(e){return!(!e||e.length<8)&&!!le(e,"MM/DD/YYYY",!0).isValid()},de=function(e){if(ue(e)){var t=new Date(+e.substring(6,10),+e.substring(0,2)-1,+e.substring(3,5));return N.fromJSDate(t)}},pe=function(e){var t=N.now(),i=t.year,r=t.month,n=t.day,o=e.year,s=e.month,a=e.day,c=i-o,l=0;r>=s?l=r-s:(c-=1,l=12+r-s);var u=0;return n>=a?u=n-a:(u=31+n-a,(l+=-1)<0&&(l=11,c-=1)),{days:u,months:l,years:c}},fe=function(e){if(e&&ue(e)){var t=de(e);if(t)return pe(t)}};function ye(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ge(e,t,i){return t&&ye(e.prototype,t),i&&ye(e,i),e}var be=function(){function e(){_(this,e)}return ge(e,null,[{key:"sanitize",value:function(e){return e.toLowerCase().trim()}},{key:"matches",value:function(t,i){return!(!t||!i)&&e.sanitize(t)===e.sanitize(i)}}]),e}();function he(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ve(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?he(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):he(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var me=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return console.log(ve({},t))},Oe=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(i||r)&&me("Created an empty element",i,r),e(t,{children:i},void 0)},Se=function(){function t(){_(this,t)}return ge(t,null,[{key:"getHeader",value:function(t,i){var r,n,o=null===(r=t.step)||void 0===r?void 0:r.title;if(!o)return Oe();i.steps.showStepId&&(o="".concat(null===(n=t.step)||void 0===n?void 0:n.id,": ").concat(o));return e("h3",Object.assign({className:"usa-card__heading ".concat(re.STEP_HEADER)},{children:o}),void 0)}},{key:"getSubtitle",value:function(t){var i,r=null===(i=t.step)||void 0===i?void 0:i.subTitle;return r?e("p",{className:re.STEP_SUBTITLE,dangerouslySetInnerHTML:{__html:r}},void 0):Oe()}},{key:"getInfoBox",value:function(t){var i,r=null===(i=t.step)||void 0===i?void 0:i.info;return r?e(f,Object.assign({variant:"info",showIcon:!1,className:"outline-1px ".concat(re.STEP_INFO)},{children:r}),void 0):Oe()}},{key:"getFooter",value:function(t){var i,r=null===(i=t.step)||void 0===i?void 0:i.footer;return r?e("p",{className:"font-sans-6 ".concat(re.STEP_FOOTER),dangerouslySetInnerHTML:{__html:r}},void 0):Oe()}},{key:"resetQuestionable",value:function(e){e.dispatchForm({type:ee.RESET}),e.wizard.goToStep("A")}},{key:"saveAsJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"questionable.json",i=new Blob([e],{type:"text/plain;charset=utf-8"});q.saveAs(i,t)}}]),t}(),Pe=function(r){if(!Q().config.dev)return Oe();return i(t,{children:[e(y,{items:[{content:e("pre",{children:e("code",{children:JSON.stringify(r.form,null,4)},void 0)},void 0),expanded:!1,id:"developer-output",title:"Temporary developer panel"}]},void 0),e("br",{},void 0),e("nav",Object.assign({className:re.NAVBAR},{children:e(g,Object.assign({type:"reset",secondary:!0,onClick:function(){return Se.resetQuestionable(r)}},{children:"Reset"}),void 0)}),void 0)]},void 0)},we=function(t){var i=Q(),r=i.config,n=i.questionnaire;if(r.progressBar.hide)return Oe();var o=n.getProgressPercent(t,r);return e("div",Object.assign({className:re.PROGRESS_BAR},{children:e(D,{completed:o,bgColor:r.progressBar.bgColor,baseBgColor:r.progressBar.baseBgColor,isLabelVisible:!1,borderRadius:"0px"},void 0)}),void 0)},je=function(t){return e(h,{label:t.name,status:t.status||"incomplete"},t.id)},Te=function(t){var i=Q(),r=i.config,n=i.questionnaire;if(r.progressBar.hide)return Oe();var o=n.getSections(t,r);return 0===o.length?Oe():e(b,Object.assign({centered:!0,counters:"small"},{children:o.map(je)}),void 0)},Ee=function(t){var i=t.props,r=t.position,n=Q().config;if(n.progressBar.hide||n.progressBar.position!==r)return Oe();switch(n.progressBar.type){case"progress-bar":return e(we,Object.assign({},i),void 0);case"step-indicator":return e(Te,Object.assign({},i),void 0);default:return Oe("Could not find progress type",n.progressBar.type)}},Ie={$schema:"http://json-schema.org/draft-07/schema#",definitions:{ACTION:{enum:["call","hybrid","online"],type:"string"},DESIGN_TYPE:{const:"Edit",description:"Defines the known component types for design",type:"string"},IAction:{description:"Represents something the customer can do in response to receiving a result",properties:{action:{title:"Action",type:"string"},description:{title:"Description",type:"string"},name:{type:"string"},title:{title:"Title",type:"string"},type:{$ref:"#/definitions/ACTION",title:"Type"}},required:["action","description","name","title","type"],type:"object"},IButtonConfig:{description:"Configuration for buttons",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},required:["defaultLabel","horizontalPos","mode","verticalPos"],type:"object"},IDesignData:{description:"Data defintion for design step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IStep",description:"Current step"}},required:["form","step"],type:"object"},IForm:{description:"Represents the survey as completed by the user",properties:{age:{$ref:"#/definitions/TAge",description:"Customer's age in years/months/days",title:"Age"},birthdate:{description:"Customer's entered birthdate",title:"Birthdate",type:"string"},finished:{description:"Time the survey was completed",format:"date-time",title:"Finished",type:"string"},responses:{description:"All currently provided responses",items:{$ref:"#/definitions/IQuestion"},title:"Responses",type:"array"},started:{description:"Time the survey was started",format:"date-time",title:"Started",type:"string"}},required:["responses","started"],type:"object"},INavButton:{description:"Represents a navigation button",properties:{label:{description:"Text to display on button (e.g. 'Prev' or 'Next')",type:"string"}},required:["label"],type:"object"},INavigationConfig:{description:"Configuration for navigation",properties:{next:{description:"Next/Forward button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"},prev:{description:"Previous/Go back button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"}},required:["next","prev"],type:"object"},IPage:{description:"Defines step content for Page types",properties:{body:{description:"Defines the body content of the page",title:"Body",type:"string"},bodyHeader:{description:"Optional header to display above body",title:"Body Heading",type:"string"},bodySubHeader:{description:"Optional sub header to display below Body Heading",title:"Body Subheading",type:"string"},buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/PAGE_TYPE",description:"Type of page",title:"Page Type"}},required:["section","title","type"],type:"object"},IPageData:{description:"Data defintion for page step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IPage",description:"Current step"}},required:["form","step"],type:"object"},IPages:{description:"Defines required pages for the survey flow",properties:{landingPage:{$ref:"#/definitions/IPage",description:"First step of the survey",title:"Landing Page"},noResultsPage:{$ref:"#/definitions/IPage",description:"Last step of the survey if there are 0 results",title:"No Results Page"},resultsPage:{$ref:"#/definitions/IPage",description:"Last step of the survey if there are 1 or more results",title:"Results Page"},summaryPage:{$ref:"#/definitions/IPage",description:"Preview of survery before submitting to receive results",title:"Summary Page"}},required:["landingPage","noResultsPage","resultsPage","summaryPage"],type:"object"},IProgressBarConfig:{description:"Configuration options for the progress bar",properties:{baseBgColor:{description:"Color of the non-completed pb",title:"Base Background Color",type:"string"},bgColor:{description:"Color of the completed pb",title:"Background Color",type:"string"},hide:{default:!1,description:"Toggles whether to show progress bar",title:"Show Progress Bar",type:"boolean"},position:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation of the progress bar",title:"Position"},type:{$ref:"#/definitions/TProgressBarType",description:"Component type\n\nCan be one of two types: (1) The USWDS Step Indicator @see https://trussworks.github.io/react-uswds/?path=/docs/components-step-indicator (2) React progress bar @see https://katerinalupacheva.github.io/react-progress-bar/",title:"Type"}},required:["baseBgColor","bgColor","hide","position","type"],type:"object"},IQuestion:{description:"Defines step content for Question type",properties:{answers:{description:"Collection of allowed answers",items:{$ref:"#/definitions/IQuestionAnswer"},title:"Answers",type:"array"},buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/QUESTION_TYPE",description:"Type of question",title:"Question Type"}},required:["answers","section","title","type"],type:"object"},IQuestionAnswer:{description:"Definition for answers to questions",properties:{id:{type:"string"},order:{type:"number"},title:{type:"string"}},required:["id","title"],type:"object"},IQuestionConfig:{description:"Configuration for question display",properties:{showAnswerBorder:{default:!0,description:"Determines whether to show border on radios and checkboxes",title:"Show Answer Border",type:"boolean"}},required:["showAnswerBorder"],type:"object"},IQuestionData:{description:"Data defintion for question step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IQuestion",description:"Current step"}},required:["form","step"],type:"object"},IQuestionableConfig:{description:"Configuration for customized behavior of Questionable",properties:{mode:{$ref:"#/definitions/MODE",description:"View or edit mode",title:"Mode"},nav:{description:"Navigation configuration",properties:{next:{description:"Next/Forward button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"},prev:{description:"Previous/Go back button",properties:{defaultLabel:{description:"Default text to display if none is defined",type:"string"},horizontalPos:{$ref:"#/definitions/THorizontalPosition",description:"Horizontal orientation (left or right)",title:"Horizontal Position"},mode:{$ref:"#/definitions/TButtonMode",description:"Render mode (link or button)",title:"Mode"},verticalPos:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation (top or bottom)",title:"Vertical Position"}},type:"object"}},title:"Navigation",type:"object"},progressBar:{description:"Progress Bar configuration",properties:{baseBgColor:{description:"Color of the non-completed pb",title:"Base Background Color",type:"string"},bgColor:{description:"Color of the completed pb",title:"Background Color",type:"string"},hide:{default:!1,description:"Toggles whether to show progress bar",title:"Show Progress Bar",type:"boolean"},position:{$ref:"#/definitions/TVerticalPosition",description:"Vertical orientation of the progress bar",title:"Position"},type:{$ref:"#/definitions/TProgressBarType",description:"Component type\n\nCan be one of two types: (1) The USWDS Step Indicator @see https://trussworks.github.io/react-uswds/?path=/docs/components-step-indicator (2) React progress bar @see https://katerinalupacheva.github.io/react-progress-bar/",title:"Type"}},title:"Progress Bar",type:"object"},questions:{description:"Question configuration",properties:{showAnswerBorder:{default:!0,description:"Determines whether to show border on radios and checkboxes",title:"Show Answer Border",type:"boolean"}},title:"Question Configuration",type:"object"},steps:{description:"Step configuration",properties:{borderClass:{description:"Class determines whether cards have borders",enum:["border-ink","border-0"],title:"Border Class",type:"string"},showStepId:{default:!1,description:"Toggles whether steps' ids are shown next to the question text",title:"Show Step Id",type:"boolean"},titleClass:{description:"Class to apply to title. Use to add background to question text",enum:["bg-base-lightest",""],title:"Title Class",type:"string"}},title:"Step Configuration",type:"object"}},required:["mode","nav"],type:"object"},IQuestionnaire:{description:"Definition for survey data input",properties:{actions:{items:{$ref:"#/definitions/IAction"},type:"array"},header:{type:"string"},pages:{$ref:"#/definitions/IPages"},questions:{items:{$ref:"#/definitions/IQuestion"},type:"array"},results:{items:{$ref:"#/definitions/IResult"},type:"array"},sections:{items:{$ref:"#/definitions/ISection"},type:"array"}},required:["actions","header","pages","questions","results","sections"],type:"object"},IRequirement:{description:"Defines an individual requirement for accessing a step",properties:{explanation:{description:"User facing description of this requirement",title:"Exlanation",type:"string"},maxAge:{$ref:"#/definitions/TAge",description:"Optional maximum age allowed for this requirement",title:"Maximum Age"},minAge:{$ref:"#/definitions/TAge",description:"Optional minimum age allowed for this requirement",title:"Minimum Age"},responses:{description:"Map of step id to required answer values",items:{$ref:"#/definitions/IResponse"},title:"Answers",type:"array"}},required:["responses"],type:"object"},IResponse:{description:"Acceptable responses",properties:{answers:{items:{properties:{id:{type:"string"},order:{type:"number"},title:{type:"string"}},type:"object"},type:"array"},question:{properties:{answers:{description:"Collection of allowed answers",items:{$ref:"#/definitions/IQuestionAnswer"},title:"Answers",type:"array"},buttons:{},footer:{},info:{},internalNotes:{},requirements:{},section:{},subTitle:{},title:{},type:{$ref:"#/definitions/QUESTION_TYPE",description:"Type of question",title:"Question Type"}},type:"object"}},required:["answers","question"],type:"object"},IResult:{description:"Represents a potential result based on a customer's answers",properties:{label:{description:"Identify the result (e.g. 'Benefit name')",title:"Label",type:"string"},name:{description:"Name of this result",title:"Name",type:"string"},requirements:{description:"Collection of requirements required to achieve this result",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},required:["label","name","requirements"],type:"object"},ISection:{description:"Defines a survey section, used in progress bar",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},required:["name","requirements"],type:"object"},IStep:{description:"Generic step data definition. Applies to all types of steps.",properties:{buttons:{description:"Collection of navigation buttons",properties:{next:{$ref:"#/definitions/INavButton",description:"Next button",title:"Next Button"},prev:{$ref:"#/definitions/INavButton",description:"Previous / Back button",title:"Prev Button"}},title:"Buttons",type:"object"},footer:{description:"Optional footer text to display at the bottom of the step",title:"Footer",type:"string"},info:{description:"Contextual content to display below the step contents and above the footer",title:"Info",type:"string"},internalNotes:{description:"Private/internal use only notes for documenting this step",title:"Internal Notes",type:"string"},requirements:{description:"Collection of requirements to view this step",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"},section:{description:"Section to which this step belongs",properties:{name:{description:"The display name of this section",title:"Name",type:"string"},requirements:{description:"Collection of requirements to enable display of this status",items:{$ref:"#/definitions/IRequirement"},title:"Requirements",type:"array"}},title:"Section",type:"object"},subTitle:{description:"Text to display below the title",title:"Subtitle",type:"string"},title:{description:"Display name of the step",title:"Title",type:"string"},type:{$ref:"#/definitions/TStepType",description:"Step's type, usually implemented by @see{IPageStep} or @see{IQuestionStep}",title:"Step Type"}},required:["section","title","type"],type:"object"},IStepConfig:{description:"Customizations for styling and formatting of the steps",properties:{borderClass:{description:"Class determines whether cards have borders",enum:["border-ink","border-0"],title:"Border Class",type:"string"},showStepId:{default:!1,description:"Toggles whether steps' ids are shown next to the question text",title:"Show Step Id",type:"boolean"},titleClass:{description:"Class to apply to title. Use to add background to question text",enum:["bg-base-lightest",""],title:"Title Class",type:"string"}},required:["borderClass","showStepId","titleClass"],type:"object"},IStepData:{description:"Data defintion for base wizard step",properties:{form:{$ref:"#/definitions/IForm",description:"The user's current form state",title:"Form"},step:{$ref:"#/definitions/IStep",description:"Current step",title:"Step"}},required:["form"],type:"object"},MODE:{enum:["dev","edit","view"],type:"string"},PAGE_TYPE:{description:"Defines the known component types for pages",enum:["Landing","No Results","Results","Summary"],type:"string"},QUESTION_TYPE:{description:"Defines the known component types for questions",enum:["dob","multiple_choice","multiple_select"],type:"string"},TAge:{properties:{days:{maximum:31,minimum:0,title:"Days",type:["number","null"]},months:{maximum:31,minimum:0,title:"Months",type:["number","null"]},years:{maximum:100,minimum:0,title:"Years",type:["number","null"]}},required:["months","years"],type:"object"},TButtonMode:{enum:["link","button"],type:"string"},THorizontalPosition:{enum:["left","right"],type:"string"},TProgressBarType:{enum:["step-indicator","progress-bar"],type:"string"},TStepType:{anyOf:[{$ref:"#/definitions/PAGE_TYPE"},{$ref:"#/definitions/QUESTION_TYPE"},{$ref:"#/definitions/DESIGN_TYPE"}]},TVerticalPosition:{enum:["top","bottom"],type:"string"}}};function Re(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ne(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Re(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var qe={properties:{step:{$ref:"#/definitions/IStep",title:"Step"}}},De=Ne(Ne({type:"object"},qe),Ie),Ce=function(){function t(){_(this,t)}return ge(t,null,[{key:"getReason",value:function(e,t,i){var r,n=null===(r=t.match)||void 0===r?void 0:r.explanation,o=i.questionnaire,s=i.config;if(!n)return"";if(null!=s&&s.dev&&t.match){var a,c;if(n+="<br><br>",void 0!==t.match.ageCalc||void 0!==t.match.minAge||void 0!==t.match.maxAge)n+="You are ".concat(null===(a=e.form.age)||void 0===a?void 0:a.years," years "),n+="and ".concat(null===(c=e.form.age)||void 0===c?void 0:c.months," months old. ");Object.keys(t.match.responses).forEach((function(e){var t=o.getQuestionById(e);n+='You answered "<b>'.concat(t.answer,'</b>" to the question "<i>').concat(t.title,'.</i>" ')}))}return n}},{key:"getResults",value:function(r,n){return n.questionnaire.getResults(r.form).map((function(o){return i("li",Object.assign({className:"padding-bottom-2"},{children:[i("span",{children:[o.label,":","  ",e("b",{children:o.name},void 0)]},void 0),e("div",{className:"text-light",dangerouslySetInnerHTML:{__html:t.getReason(r,o,n)}},void 0)]}),"".concat(r.stepId,"_").concat(o.id))}))}}]),t}(),Ae=function(){function e(){_(this,e)}return ge(e,null,[{key:"goToStep",value:function(e,t){t.wizard.goToStep(e)}},{key:"goToNextStep",value:function(t,i,r){e.goToStep(i.getNextStep(t,r),t)}},{key:"goToPrevStep",value:function(t,i,r){e.goToStep(i.getPreviousStep(t,r),t)}},{key:"isNextEnabled",value:function(t){var i,r,n;if(null==t||!t.step)throw new Error("This survery is not defined");return t.stepId===ne.LANDING||(t.stepId===ne.SUMMARY||!!t.form&&((null===(i=t.step)||void 0===i?void 0:i.type)===x.DOB?void 0!==(null===(r=t.form)||void 0===r||null===(n=r.age)||void 0===n?void 0:n.years)&&t.form.age.years>=0:e.isValid(t.form,t.step.id)))}},{key:"isValid",value:function(e,t){var i,r=e.responses.find((function(e){return e.id===t}));if(!r)return!1;var n=l(r.answers);switch(r.type){case ne.DOB:return void 0!==(null==e||null===(i=e.age)||void 0===i?void 0:i.years)&&e.age.years>0;case ne.MULTIPLE_CHOICE:return void 0!==r.answer&&void 0!==(null==n?void 0:n.find((function(e){return e.title===r.answer})));default:return!0}}},{key:"getFieldSetName",value:function(e){return u(e.step.title)}},{key:"getDomId",value:function(t,i){var r=e.getFieldSetName(i);return"".concat(r,"-").concat(u(t))}}]),e}(),Be=function(){function t(){_(this,t)}return ge(t,null,[{key:"updateForm",value:function(e,t){Object.assign(t.step,{answer:e});var i={responses:[t.step]};return t.dispatchForm({type:ee.UPDATE,value:i})}},{key:"isSelected",value:function(e,t){if(null!=t&&t.form){var i=t.form.responses.find((function(e){return e.id===t.step.id}));if(i)return Ae.isValid(t.form,t.step.id)&&i.answer===e}}},{key:"getRadio",value:function(i,r,n){var o,s=function(){return t.updateForm(i.title,r)},a=Ae.getDomId(i.title,r);return e(v,{id:a,name:Ae.getFieldSetName(r),label:i.title,value:i.title,checked:!0===t.isSelected(i.title,r),className:re.MULTI_CHOICE,onChange:s,onClick:s,tile:!0===(null===(o=n.questions)||void 0===o?void 0:o.showAnswerBorder)},a)}},{key:"getRadios",value:function(i,r){return e(m,Object.assign({legend:i.step.title,className:re.MULTI_CHOICE_GROUP,legendStyle:"srOnly"},{children:i.step.answers.map((function(e){return t.getRadio(e,i,r)}))}),void 0)}},{key:"getCheckbox",value:function(i,r,n){var o,s=function(){return t.updateForm(i.title,r)},a=Ae.getDomId(i.title,r);return e(O,{id:a,name:Ae.getFieldSetName(r),label:i.title,value:i.title,checked:!0===t.isSelected(i.title,r),className:re.MULTI_SELECT,onChange:s,onClick:s,tile:!0===(null===(o=n.questions)||void 0===o?void 0:o.showAnswerBorder)},a)}},{key:"getCheckboxes",value:function(i,r){return e(m,Object.assign({legend:i.step.title,className:re.MULTI_SELECT_GROUP,legendStyle:"srOnly"},{children:i.step.answers.map((function(e){return t.getCheckbox(e,i,r)}))}),void 0)}},{key:"getBirthdate",value:function(e){var t;if(null!==(t=e.form)&&void 0!==t&&t.birthdate)return de(e.form.birthdate)}},{key:"toBirthdate",value:function(e){if(e.month&&e.day&&e.year)return"".concat(e.month.padStart(2,"0"),"/").concat(e.day.padStart(2,"0"),"/").concat(e.year)}}]),t}(),ke=function(t){return e(g,Object.assign({className:"".concat(re.NAVBAR_BUTTON," ").concat(re.NAVBAR_BUTTON,"-").concat(t.dir),"data-testid":"".concat(t.dir,"-button-").concat(t.stepId),disabled:t.disabled(),onClick:t.onClick,type:"button",unstyled:"link"===t.mode,outline:"link"!==t.mode&&"prev"===t.dir},{children:t.label}),void 0)},Le=function(t){var i,r,n=Q(),o=n.questionnaire,s=n.config,a=t.step,c=t.verticalPos!==s.nav.prev.verticalPos,l=t.stepId===ne.LANDING||t.stepId===o.flow[1],u=t.stepId===ne.RESULTS||t.stepId===ne.NO_RESULTS,d=s.mode!==ie.EDIT||t.stepId===o.flow[0]&&s.mode===ie.EDIT;if(c||(l||u)&&d)return Oe();var p=(null==a||null===(i=a.buttons)||void 0===i||null===(r=i.prev)||void 0===r?void 0:r.label)||s.nav.prev.defaultLabel||"Previous";return e(ke,Object.assign({},{dir:"prev",disabled:function(){return!1},label:p,mode:s.nav.prev.mode||"link",onClick:function(){return Ae.goToPrevStep(t,o,s)},stepId:"".concat(t.stepId)}),void 0)},_e=function(t){var i,r,n=Q(),o=n.questionnaire,s=n.config,a=t.step,c=t.verticalPos!==s.nav.next.verticalPos,l=t.stepId===ne.RESULTS||t.stepId===ne.NO_RESULTS,u=s.mode!==ie.EDIT||t.stepId===o.flow[o.flow.length-1]&&s.mode===ie.EDIT;if(c||l&&u)return Oe();var d=(null==a||null===(i=a.buttons)||void 0===i||null===(r=i.next)||void 0===r?void 0:r.label)||s.nav.next.defaultLabel||"Previous";return e(ke,Object.assign({},{dir:"next",disabled:function(){return s.mode===ie.VIEW&&!Ae.isNextEnabled(t)},label:d,mode:s.nav.next.mode||"button",onClick:function(){return Ae.goToNextStep(t,o,s)},stepId:"".concat(t.stepId)}),void 0)},xe=function(t){return i("nav",Object.assign({className:"".concat(re.NAVBAR," ").concat(re.NAVBAR,"-").concat(t.verticalPos)},{children:[e(Le,Object.assign({},t),void 0),e(_e,Object.assign({},t),void 0)]}),void 0)};function Ue(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Me(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ue(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var $e=function(t){var r=Q().questionnaire;return i("div",{children:[e(xe,Object.assign({},Me(Me({},t),{},{verticalPos:"top"})),void 0),e("section",{children:e(S,{children:i(P,Object.assign({headerFirst:!0,gridLayout:{tablet:{col:12}},containerProps:{className:"border-ink"}},{children:[e(w,Object.assign({className:"bg-base-lightest"},{children:i("h1",{children:["Edit the ",r.header]},void 0)}),void 0),e(j,Object.assign({className:"padding-top-3"},{children:t.children}),void 0),e(T,{children:'Click "Save" to save your edits, or "Next" to continue editing'},void 0)]}),void 0)},void 0)},void 0)]},void 0)},He=function(t){var i=Q().questionnaire,r=function(e){var t=Ne({},qe);return oe(U,e.step.type)?t.properties.step.$ref="#/definitions/IPage":oe(x,e.step.type)&&(t.properties.step.$ref="#/definitions/IQuestion"),c(t,De)}(t),n=u(i.header);return e(C,Object.assign({schema:r,uiSchema:{step:{"ui:order":["title","subTitle","bodyHeader","bodySubHeader","body","info","footer","*"]}},onSubmit:function(e){var t=e.formData;Se.saveAsJson(t,"".concat(n,".json"))},formData:{step:t.step}},{children:e("div",{children:e(g,Object.assign({type:"submit"},{children:"Save"}),void 0)},void 0)}),void 0)},Fe=function(t){return e($e,Object.assign({},t,{children:e(He,Object.assign({},t),void 0)}),void 0)};function Ve(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ye(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ve(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ze(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Qe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ze(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Ge=function(t){var r=Q().config,n=r.steps,o=n.borderClass,s=n.titleClass;return i("div",{children:[e(xe,Object.assign({},Qe(Qe({},t),{},{verticalPos:"top"})),void 0),e("section",Object.assign({className:re.STEP_LAYOUT},{children:e(S,{children:i(P,Object.assign({headerFirst:!0,gridLayout:{tablet:{col:12}},containerProps:{className:o}},{children:[e(w,Object.assign({className:s},{children:Se.getHeader(t,r)}),void 0),i(j,{children:[Se.getSubtitle(t),t.children,Se.getInfoBox(t)]},void 0),e(T,{children:Se.getFooter(t)},void 0)]}),void 0)},void 0)}),void 0),e(xe,Object.assign({},Qe(Qe({},t),{},{verticalPos:"bottom"})),void 0)]},void 0)},We=function(t){var i=t.step;return i?e(Ge,Object.assign({},t,{children:e("p",{children:i.body},void 0)}),void 0):Oe()},Je=function(t){return t.step?e(Ge,Object.assign({},t),void 0):Oe()},Ke=function(t){var r=t.step,n=Q(),o=n.questionnaire;if(!r)return Oe();var s=o.getAction();return e(Ge,Object.assign({},t,{children:i(E,Object.assign({heading:r.bodyHeader||"",className:re.RESULTS_SUMMARY_HEADER},{children:[e("p",{children:r.bodySubHeader},void 0),e("ul",Object.assign({className:"usa-list usa-list--unstyled ".concat(re.RESULTS_SUMMARY_BOX)},{children:Ce.getResults(t,n)}),void 0),e("p",{dangerouslySetInnerHTML:{__html:(null==r?void 0:r.body)||""}},void 0),e("h2",{children:s.title},void 0),e("p",{children:s.description},void 0),e("p",{dangerouslySetInnerHTML:{__html:s.action}},void 0),"."]}),void 0)}),void 0)},Xe=function(t){var r=t.form.responses.map((function(t){return e("li",Object.assign({className:"padding-bottom-2"},{children:i("span",Object.assign({className:"text-light"},{children:[t.title,":  ",e("b",{children:t.answer},void 0)]}),void 0)}),t.id)}));return e("ul",Object.assign({className:"usa-list usa-list--unstyled"},{children:r}),void 0)},Ze=function(t){return t.step?e(Ge,Object.assign({},t,{children:Xe(t)}),void 0):Oe()};function et(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function tt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?et(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):et(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function it(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}var rt=function(t){var r,o,s,a,c,l,u=t.step,p={day:null===(r=Be.getBirthdate(t))||void 0===r||null===(o=r.day)||void 0===o?void 0:o.toString(),month:null===(s=Be.getBirthdate(t))||void 0===s||null===(a=s.month)||void 0===a?void 0:a.toString(),year:null===(c=Be.getBirthdate(t))||void 0===c||null===(l=c.year)||void 0===l?void 0:l.toString()},f=L(n(p),2),y=f[0],g=f[1];if(!u)return Oe();var b,h=function(e,i){var r=e.target.value;if(r){y[i]=r,g(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?it(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):it(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},y));var n=Be.toBirthdate(y),o=fe(n);o&&t.dispatchForm({type:ee.UPDATE,value:{age:o,birthdate:n}})}},v=function(i,r){var n=2;return i===te.YEAR&&(n=4),e(R,{id:Ae.getDomId(i,t),name:r,label:d(i),unit:i,maxLength:n,minLength:n,defaultValue:y[i],onChange:function(e){return h(e,i)}},void 0)};return b="date_of_birth",i(I,{children:[v(te.MONTH,b),v(te.DAY,b),v(te.YEAR,b)]},void 0)},nt=function(t){return e(Ge,Object.assign({},t,{children:e(rt,Object.assign({},t),void 0)}),void 0)},ot=function(e){var t,i=Q().config;return void 0===(null==e||null===(t=e.step)||void 0===t?void 0:t.answers)?Oe():Be.getCheckboxes(e,i)},st=function(t){return e(Ge,Object.assign({},t,{children:e(ot,Object.assign({},t),void 0)}),void 0)},at=function(e){var t,i=Q().config;return void 0===(null==e||null===(t=e.step)||void 0===t?void 0:t.answers)?Oe("Question and answer are not defined"):Be.getRadios(e,i)},ct=function(t){return e(Ge,Object.assign({},t,{children:e(at,Object.assign({},t),void 0)}),void 0)};function lt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ut(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):lt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var dt=function(t,i){return oe(x,i.type)?function(t){var i=t.stepId,r=Q().questionnaire,n=r.getStepById("".concat(i));if(!oe(x,n.type))return Oe("Not a question");var o=r.getQuestionById(n.id),s=ut({},ut({step:o},t));switch(o.type){case x.DOB:return e(nt,Object.assign({},s),void 0);case x.MULTIPLE_CHOICE:return e(ct,Object.assign({},s),void 0);case x.MULTIPLE_SELECT:return e(st,Object.assign({},s),void 0);default:return Oe("Question does not exist","QuestionFactory")}}(t):oe(U,i.type)?function(t){var i=t.stepId,r=Q().questionnaire,n=r.getStepById("".concat(i));if(!oe(U,n.type))return Oe("Not a page");var o=r.getPageById(n.id),s=tt({},tt({step:o},t));switch(o.type){case U.LANDING:return e(We,Object.assign({},s),void 0);case U.NO_RESULTS:return e(Je,Object.assign({},s),void 0);case U.RESULTS:return e(Ke,Object.assign({},s),void 0);case U.SUMMARY:return e(Ze,Object.assign({},s),void 0);default:return Oe("Page does not exist","PageFactory")}}(t):Oe("Step does not exist","StepFactory")},pt=function(t){var i=t.stepId,r=Q(),n=r.questionnaire,o=r.config,s=n.getStepById("".concat(i));return o.mode===ie.EDIT?function(t,i){var r=Ye({},Ye({step:Q().questionnaire.getStepById(i.id)},t));if(oe(x,i.type)){var n=r;return e(Fe,Object.assign({},n),void 0)}if(oe(U,i.type)){var o=r;return e(Fe,Object.assign({},o),void 0)}return Oe("Not an editable type")}(t,s):dt(t,s)},ft=function(t){var r=t.questionnaire;if(!r)throw new Error("questionable is undefined");var n=L(a(r.flow),2),o=n[0],c=n[1],l=L(s(ce,new $),2),u=l[0],d=l[1];return e(V,Object.assign({value:t},{children:i("div",Object.assign({className:re.BASE},{children:[e("section",Object.assign({className:"section ".concat(re.PROGRESS_BAR_TOP_SECTION)},{children:e(Ee,Object.assign({},{position:"top",props:{dispatchForm:d,form:u,stepId:o,wizard:c}}),void 0)}),void 0),e("section",Object.assign({className:"section ".concat(re.STEP_LAYOUT_SECTION)},{children:e(pt,Object.assign({},{dispatchForm:d,form:u,stepId:o,wizard:c}),void 0)}),void 0),e("section",Object.assign({className:"section ".concat(re.PROGRESS_BAR_BOTTOM_SECTION)},{children:e(Ee,Object.assign({},{position:"bottom",props:{dispatchForm:d,form:u,stepId:o,wizard:c}}),void 0)}),void 0),e("section",Object.assign({className:"section ".concat(re.DEV_PANEL_SECTION)},{children:e(Pe,Object.assign({},{dispatchForm:d,form:u,stepId:o,wizard:c}),void 0)}),void 0)]}),void 0)}),void 0)};function yt(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var gt=0;function bt(e){return"__private_"+gt+++"_"+e}function ht(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function vt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ht(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var mt=bt("mode"),Ot=bt("nav"),St=bt("progressBar"),Pt=bt("questions"),wt=bt("steps"),jt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_(this,e),Object.defineProperty(this,mt,{writable:!0,value:ie.VIEW}),Object.defineProperty(this,Ot,{writable:!0,value:{next:{defaultLabel:"Next",horizontalPos:"left",mode:"button",verticalPos:"bottom"},prev:{defaultLabel:"Go back",horizontalPos:"left",mode:"link",verticalPos:"top"}}}),Object.defineProperty(this,St,{writable:!0,value:{baseBgColor:"#f0f0f0",bgColor:"#005ea2",hide:!1,position:"bottom",type:"progress-bar"}}),Object.defineProperty(this,Pt,{writable:!0,value:{showAnswerBorder:!0}}),Object.defineProperty(this,wt,{writable:!0,value:{borderClass:"border-0",showStepId:!1,titleClass:""}}),c(this,t),this.dev&&(yt(this,wt)[wt].showStepId=!0)}return ge(e,[{key:"dev",get:function(){return yt(this,mt)[mt]===ie.DEV}},{key:"mode",get:function(){return yt(this,mt)[mt]},set:function(e){p(e)?oe(ie,e)?yt(this,mt)[mt]=e:yt(this,mt)[mt]=ie.VIEW:yt(this,mt)[mt]=e}},{key:"nav",get:function(){return vt({},yt(this,Ot)[Ot])},set:function(e){c(yt(this,Ot)[Ot],e)}},{key:"progressBar",get:function(){return vt({},yt(this,St)[St])},set:function(e){c(yt(this,St)[St],e)}},{key:"questions",get:function(){return vt({},yt(this,Pt)[Pt])},set:function(e){c(yt(this,Pt)[Pt],e)}},{key:"steps",get:function(){return vt({},yt(this,wt)[wt])},set:function(e){c(yt(this,wt)[wt],e)}}]),e}();function Tt(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":Et(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}var Rt={buttons:{next:{label:"Get Started"}},id:U.LANDING,section:{id:U.LANDING},title:U.LANDING,type:U.LANDING},Nt={id:U.RESULTS,section:{id:U.RESULTS},title:U.RESULTS,type:U.RESULTS},qt={landingPage:Rt,noResultsPage:{id:U.NO_RESULTS,section:{id:U.RESULTS},title:U.NO_RESULTS,type:U.NO_RESULTS},resultsPage:Nt,summaryPage:{buttons:{next:{label:"Submit"}},id:U.SUMMARY,section:{id:U.RESULTS},title:U.SUMMARY,type:U.SUMMARY}};function Dt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}var Ct=function(){function e(t){_(this,e),this.questions=void 0,this.header=void 0,this.results=void 0,this.flow=void 0,this.sections=void 0,this.actions=void 0,this.pages=qt,this.steps=void 0,Object.assign(this,t),this.steps=Tt(this.questions),this.init(),this.flow=this.steps.map((function(e){return e.id}))}return ge(e,[{key:"getStepById",value:function(e){var t=this.steps.find((function(t){return t.id===e}));if(!t)throw new Error("Step id: ".concat(e," not found in survery"));return t}},{key:"getPageById",value:function(e){var t=this.getStepById(e);if(!oe(U,t.type))throw new Error("Step id: ".concat(e," is not a page"));return t}},{key:"getQuestion",value:function(e){if(!e.id)throw new Error("Question ".concat(e," is not defined"));return this.getQuestionById(e.id)}},{key:"getQuestionById",value:function(e){var t=this.getStepById(e);if(!oe(x,t.type))throw new Error("Step id: ".concat(e," not a question"));return t}},{key:"getStep",value:function(e,t,i){var r=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new jt,o=-1!==this.flow.indexOf(e)?this.flow[this.flow.indexOf(e)+i]:void 0;if(!o)return e;if(n.mode===ie.EDIT)return o;if(o===ne.RESULTS&&0===this.getResults(t).length)return ne.NO_RESULTS;if(o===ne.NO_RESULTS&&this.getResults(t).length>0)return ne.RESULTS;var s,a=this.getStepById(o);if(null==a||!a.requirements)return o;if(a.requirements.forEach((function(e){var i=r.meetsAllRequirements(e,t);s=void 0===s?i:s||i})),s)return o;var c=this.getStep(o,t,i);return c!==o?c:e}},{key:"getNextStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jt,i=e.stepId;return this.getStep(i,e.form,K.FORWARD,t)}},{key:"getPreviousStep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jt,i=e.stepId;return this.getStep(i,e.form,K.BACKWARD,t)}},{key:"getProgressPercent",value:function(e,t){var i,r;if(be.matches(null===(i=e.step)||void 0===i||null===(r=i.section)||void 0===r?void 0:r.id,U.RESULTS))return 100;var n=this.getSections(e,t),o=n[n.length-1];if(null==o||!o.lastStep)return.5;var s=this.flow.indexOf("".concat(e.stepId)),a=o.lastStep+2;return t.mode===ie.EDIT&&(a=this.flow.length-1),Math.round(s/a*100)}},{key:"getSections",value:function(e,t){var i=this;if(!e)return[];var r=e.stepId,n=this.getStepById(r),o=this.steps.indexOf(n),s=this.sections.filter((function(t){return 0===t.requirements.length||t.requirements.some((function(t){return i.meetsAllRequirements(t,e.form)}))}));return t.mode===ie.EDIT&&(s=Tt(this.sections)),s.map((function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Dt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e);return t.lastStep=i.questions.reduce((function(t,i,r){return i.section.id===e.id?r:t}),-1),be.matches(t.id,U.RESULTS)?t.lastStep=i.questions.length-2:be.matches(t.id,U.LANDING)&&(t.lastStep=0),t.lastStep<0?t.status=X.INCOMPLETE:be.matches(t.id,n.section.id)?t.status=X.CURRENT:t.lastStep<o&&(t.status=X.COMPLETE),t}))}},{key:"getResults",value:function(e){var t=this;return this.results.filter((function(i){return i.requirements.some((function(r){return!!t.meetsAllRequirements(r,e)&&(Object.assign(i,{match:r}),!0)}))}))}},{key:"getAction",value:function(){var e=Math.floor(Math.random()*this.actions.length);return this.actions[e]}},{key:"init",value:function(){var e,t,i;if((null===(e=this.questions)||void 0===e?void 0:e.length)<=0)throw new Error("No questions have been defined.");if((null===(t=this.header)||void 0===t?void 0:t.length)<=0)throw new Error("No header has been defined.");if((null===(i=this.results)||void 0===i?void 0:i.length)<=0)throw new Error("No results have been defined.");var r="step is not correctly defined or defined more than once";if(this.steps[0].type!==U.LANDING&&this.steps.unshift(this.pages.landingPage),1!==this.steps.filter((function(e){return e.type===U.LANDING})).length)throw new Error("".concat(U.LANDING," ").concat(r,"."));if(this.steps[this.steps.length-1].type!==U.NO_RESULTS&&this.steps.push(this.pages.noResultsPage),1!==this.steps.filter((function(e){return e.type===U.NO_RESULTS})).length)throw new Error("".concat(U.NO_RESULTS," ").concat(r,"."));if(this.steps[this.steps.length-2].type!==U.RESULTS&&this.steps.splice(this.steps.length-1,0,this.pages.resultsPage),1!==this.steps.filter((function(e){return e.type===U.RESULTS})).length)throw new Error("".concat(U.RESULTS," ").concat(r,"."));if(this.steps[this.steps.length-3].type!==U.SUMMARY&&this.steps.splice(this.steps.length-2,0,this.pages.summaryPage),1!==this.steps.filter((function(e){return e.type===U.SUMMARY})).length)throw new Error("".concat(U.SUMMARY," ").concat(r,"."))}},{key:"meetsAllRequirements",value:function(t,i){var r=t.minAge,n=t.maxAge,o=t.responses,s=t.ageCalc;return e.meetsMinAgeRequirements(i,r)&&e.meetsMaxAgeRequirements(i,n)&&e.meetsAgeCalcRequirements(i,s)&&this.meetsAnswerRequirements(o)}},{key:"meetsAnswerRequirements",value:function(e){var t=this;return!e||e.length<=0||e.every((function(e){var i,r=t.getQuestion(e.question);return!((null===(i=r.answers)||void 0===i?void 0:i.length)>0)||e.answers.some((function(e){var t;return void 0!==r.answer&&r.answer===(null===(t=r.answers.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.title)}))}))}}],[{key:"meetsMinAgeRequirements",value:function(e,t){if(!t)return!0;if(void 0===e.age)return!1;var i=e.age,r=i.years,n=i.months;return r>(null==t?void 0:t.years)||r>=(null==t?void 0:t.years)&&n>=(null==t?void 0:t.months)}},{key:"meetsMaxAgeRequirements",value:function(e,t){if(!t)return!0;if(void 0===e.age)return!1;var i=e.age,r=i.years,n=i.months;return r<(null==t?void 0:t.years)||r<=(null==t?void 0:t.years)&&n<=(null==t?void 0:t.months)}},{key:"meetsAgeCalcRequirements",value:function(e,t){return!t||void 0!==e.birthdate&&t(e.birthdate)}}]),e}();It([A((function(e){return e.id}))],Ct.prototype,"questions",void 0),It([A((function(e){return e.label}))],Ct.prototype,"results",void 0),It([A((function(e){return e.id}))],Ct.prototype,"sections",void 0);export{Z as ACTION,ee as ACTION_TYPE,$ as Answer,re as CSS_CLASS,te as DATE_UNIT,M as DESIGN_TYPE,K as DIRECTION,be as Helpers,ie as MODE,U as PAGE_TYPE,X as PROGRESS_BAR_STATUS,x as QUESTION_TYPE,ft as Questionable,jt as QuestionableConfig,Ct as Questionnaire,ne as STEP_TYPE,fe as getAge,de as getDateTime,pe as getDateTimeAge,oe as isEnum,ue as isValidDate,Ie as survey};
//# sourceMappingURL=index.esm.js.map
